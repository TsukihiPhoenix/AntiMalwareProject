#include "mainwindow.h"
#include "ui_mainwindow.h"

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);

    nbfound = 0;
}

MainWindow::~MainWindow()
{
    delete ui;
}

void MainWindow::on_pushButton_scan_clicked()
{
    qDebug() << "on_pushButton_scan_clicked";

    QStringList nameFilter("*.txt");
    QDir directory("C:\\MalwareFolder");
    QStringList txtFilesAndDirectories = directory.entryList(nameFilter);
    for(int i=0 ; i < txtFilesAndDirectories.length() ; i++)
    {
        qDebug() << txtFilesAndDirectories.at(i);
    }


    nbfound =  txtFilesAndDirectories.length();
    arbo = new QString[nbfound];
    deleteitembox = new QCheckBox[nbfound];
    filter = new bool[nbfound];
    modal = new QStandardItemModel(nbfound,2,this);
    modal->setHeaderData(0, Qt::Horizontal, tr("Nom"));
    QModelIndex index;

    for(int i=0;i<nbfound;i++)
    {
        index = modal->index(i,0,QModelIndex());
        deleteitembox[i].setParent(this->ui->listView_detected);
        deleteitembox[i].setGeometry(ui->listView_detected->width()-30,1+(i*17),20,20);
        deleteitembox[i].setChecked(true);
        deleteitembox[i].show();
        filter[i] = true;

        modal->setData(index,txtFilesAndDirectories.at(i));

    }

    ui->listView_detected->setModel(modal);

}

void MainWindow::on_pushButton_clean_clicked()
{
    qDebug() << "on_pushButton_clean_clicked";

    for(int i=0;i<nbfound;i++)
    {
        if(deleteitembox[i].isChecked())
        {
            qDebug() << "DELETING FILE nÂ°"+QString::number(i);
        }
    }
}
